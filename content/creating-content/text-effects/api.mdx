# Plugin API

import { Callout } from 'nextra/components'

Oraxen provides a Java API for applying text effects programmatically in your plugins.

## Basic Usage

```java
import io.th0rgal.oraxen.font.TextEffect;
import net.kyori.adventure.text.Component;

// Get a specific effect definition
TextEffect.Definition rainbow = TextEffect.getEffect("rainbow");

// Apply effect to text
Component text = TextEffect.apply("Hello World!", rainbow);

// Apply by effect name
Component wave = TextEffect.apply("Wavy text!", "wave");

// Convenience methods for built-in effects
Component rainbowText = TextEffect.rainbow("Rainbow text!");
Component wavyText = TextEffect.wave("Wavy text!");
Component shakyText = TextEffect.shake("Shaky text!");
Component pulsingText = TextEffect.pulse("Pulsing text!");

// Check if effects are enabled
boolean enabled = TextEffect.isEnabled();
boolean rainbowEnabled = TextEffect.isEffectEnabled(rainbow);
boolean waveEnabled = TextEffect.isEffectEnabled("wave");
```

## Available Methods

| Method | Description |
|--------|-------------|
| `TextEffect.getEffect(name)` | Get effect definition by name |
| `TextEffect.getEffect(id)` | Get effect definition by ID |
| `TextEffect.getEffects()` | Get all available effect definitions |
| `TextEffect.getEnabledEffects()` | Get all enabled effect definitions |
| `TextEffect.apply(text, definition)` | Apply effect to text |
| `TextEffect.apply(text, name)` | Apply effect by name |
| `TextEffect.isEnabled()` | Check if text effects are enabled globally |
| `TextEffect.isEffectEnabled(definition)` | Check if a specific effect is enabled |
| `TextEffect.isEffectEnabled(name)` | Check if an effect is enabled by name |
| `TextEffect.rainbow(text)` | Apply rainbow effect |
| `TextEffect.wave(text)` | Apply wave effect |
| `TextEffect.shake(text)` | Apply shake effect |
| `TextEffect.pulse(text)` | Apply pulse effect |

## Effect Definitions

Each effect definition contains:

```java
TextEffect.Definition effect = TextEffect.getEffect("rainbow");

String name = effect.getName();           // "rainbow"
int id = effect.getId();                  // 0
String desc = effect.getDescription();    // "Cycles through rainbow colors over time"
boolean enabled = effect.isEnabled();     // true
TextColor trigger = effect.getTriggerColor(); // The trigger color for this effect
```

## MiniMessage Integration

The simplest way to use text effects is through MiniMessage tags:

```java
import io.th0rgal.oraxen.utils.AdventureUtils;

// AdventureUtils.MINI_MESSAGE includes the text effect tag resolver
Component text = AdventureUtils.MINI_MESSAGE.deserialize(
    "<effect:rainbow>Rainbow text!</effect>"
);

// Works with other MiniMessage tags
Component mixed = AdventureUtils.MINI_MESSAGE.deserialize(
    "<bold><effect:wave>Bold wavy text!</effect></bold>"
);
```

### Custom Tag Resolver

If you need to add the text effect resolver to your own MiniMessage instance:

```java
import io.th0rgal.oraxen.font.TextEffectTag;
import net.kyori.adventure.text.minimessage.MiniMessage;
import net.kyori.adventure.text.minimessage.tag.resolver.TagResolver;

MiniMessage mm = MiniMessage.builder()
    .tags(TagResolver.resolver(
        TagResolver.standard(),
        TextEffectTag.RESOLVER
    ))
    .build();

Component text = mm.deserialize("<effect:rainbow>Hello!</effect>");
```

## How Effects Work

When you apply a text effect, Oraxen:

1. Sets each character to use an **effect-specific font** (e.g., `oraxen:effect/0` for rainbow)
2. Colors each character with the effect's **trigger color** (e.g., `#FD0D00` for rainbow)
3. The shader matches this exact color and applies the visual effect

```java
// The returned component has font and color set per-character
Component rainbow = TextEffect.apply("Hi", TextEffect.getEffect("rainbow"));
// Result: Each character has font=oraxen:effect/0, color=#FD0D00
```

## PlaceholderAPI

Text effects can be combined with PlaceholderAPI:

```java
// Example: Apply effect to a placeholder result
String placeholderResult = PlaceholderAPI.setPlaceholders(player, "%player_name%");
Component effectComponent = TextEffect.apply(placeholderResult, "rainbow");
```

## Enabling/Disabling Effects

You can programmatically toggle effects:

```java
// Toggle global state
TextEffect.setGlobalEnabled(false);

// Toggle specific effects
TextEffect.setEffectEnabled("rainbow", false);

TextEffect.Definition wave = TextEffect.getEffect("wave");
TextEffect.setEffectEnabled(wave, true);
```

<Callout type="warning">
Changing effect state at runtime does not regenerate shaders. Effects can only be fully added/removed by editing `text_effects.yml` and reloading the resource pack.
</Callout>

## Performance Considerations

- Text effects are rendered client-side via shaders, so there's minimal server impact
- Effect components are computed once when created
- Cache `TextEffect.Definition` objects rather than calling `getEffect()` repeatedly
- The MiniMessage tag resolver handles all encoding automatically
